{% extends "base.html" %}

{% block content %}
{% include "smart_meter/meterbar.html" %}
{% load static %}
<div class="container mt-4">
  <h3>Switch Power</h3>
  <form method="post" class="card p-3 shadow-sm">
    {% csrf_token %}
    <div class="row g-3">
      <div class="col-md-4">{{ form.meter.label_tag }} {{ form.meter }}</div>
      <div class="col-md-8">
        {{ form.action.label_tag }}
        <div class="d-flex gap-4">{{ form.action }}</div>
      </div>
    </div>
    <div class="mt-3">
      <button class="btn btn-primary">Send</button>
      <a class="btn btn-secondary" href="{% url 'smart_meter:meter_list' %}">Back</a>
    </div>
  </form>

  {% if result %}
    <div class="alert {{ result.ok|yesno:'alert-success,alert-danger' }} mt-3">
      <div><strong>OK:</strong> {{ result.ok }}</div>
      {% if result.reply %}<div><strong>Reply (hex):</strong> <code>{{ result.reply }}</code></div>{% endif %}
      {% if result.error %}<div><strong>Error:</strong> {{ result.error }}</div>{% endif %}
    </div>
  {% endif %}
</div>

{% endblock %}
